
The following have been reloaded with a version change:
  1) flexiblas/3.3.1 => flexiblas/3.4.4       6) openmpi/4.1.5 => openmpi/5.0.3
  2) gcc/12.3 => gcc/13.3                     7) pmix/4.2.4 => pmix/5.0.2
  3) gcccore/.12.3 => gcccore/.13.3           8) ucc/1.2.0 => ucc/1.3.0
  4) hwloc/2.9.1 => hwloc/2.10.0              9) ucx/1.14.1 => ucx/1.16.0
  5) libfabric/1.18.0 => libfabric/1.21.0


The following have been reloaded with a version change:

The following have been reloaded with a version change:
  1) flexiblas/3.3.1 => flexiblas/3.4.4       6) openmpi/4.1.5 => openmpi/5.0.3
  2) gcc/12.3 => gcc/13.3                     7) pmix/4.2.4 => pmix/5.0.2
  3) gcccore/.12.3 => gcccore/.13.3           8) ucc/1.2.0 => ucc/1.3.0
  4) hwloc/2.9.1 => hwloc/2.10.0              9) ucx/1.14.1 => ucx/1.16.0
  5) libfabric/1.18.0 => libfabric/1.21.0

  1) flexiblas/3.3.1 => flexiblas/3.4.4       6) openmpi/4.1.5 => openmpi/5.0.3
  2) gcc/12.3 => gcc/13.3                     7) pmix/4.2.4 => pmix/5.0.2
  3) gcccore/.12.3 => gcccore/.13.3           8) ucc/1.2.0 => ucc/1.3.0
  4) hwloc/2.9.1 => hwloc/2.10.0              9) ucx/1.14.1 => ucx/1.16.0
  5) libfabric/1.18.0 => libfabric/1.21.0

03/21/2025 23:47:38 - WARNING - __main__ -   device: cuda:0, n_gpu: 1
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
03/21/2025 23:47:40 - INFO - __main__ -   Training/evaluation parameters Namespace(output_dir='./saved_models', model_type='t5', encoder_block_size=512, decoder_block_size=256, beam_size=50, model_name='model.bin', checkpoint_model_name='non_domain_model.bin', model_name_or_path='../codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='../codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, load_model_from_checkpoint=False, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=1, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, n_gpu=1, device=device(type='cuda', index=0))
  0%|          | 0/1706 [00:00<?, ?it/s]  1%|          | 15/1706 [00:00<00:12, 131.07it/s]  2%|▏         | 29/1706 [00:00<00:14, 117.57it/s]  2%|▏         | 41/1706 [00:00<00:17, 97.44it/s]   3%|▎         | 56/1706 [00:00<00:14, 113.02it/s]  4%|▍         | 68/1706 [00:00<00:16, 100.86it/s]  5%|▍         | 79/1706 [00:00<00:16, 97.25it/s]   5%|▌         | 92/1706 [00:00<00:15, 103.98it/s]  6%|▌         | 103/1706 [00:00<00:15, 104.90it/s]  7%|▋         | 116/1706 [00:01<00:17, 93.49it/s]   7%|▋         | 126/1706 [00:01<00:16, 93.77it/s]  8%|▊         | 136/1706 [00:01<00:17, 90.62it/s]  9%|▊         | 147/1706 [00:01<00:17, 88.84it/s]  9%|▉         | 157/1706 [00:01<00:17, 88.40it/s] 10%|▉         | 166/1706 [00:01<00:18, 84.56it/s] 10%|█         | 175/1706 [00:01<00:18, 83.48it/s] 11%|█         | 184/1706 [00:02<00:20, 73.05it/s] 12%|█▏        | 197/1706 [00:02<00:17, 84.07it/s] 12%|█▏        | 211/1706 [00:02<00:15, 98.13it/s] 13%|█▎        | 223/1706 [00:02<00:17, 86.62it/s] 14%|█▍        | 241/1706 [00:02<00:13, 108.98it/s] 15%|█▌        | 256/1706 [00:02<00:12, 119.16it/s] 16%|█▌        | 272/1706 [00:02<00:11, 128.80it/s] 17%|█▋        | 286/1706 [00:02<00:11, 120.65it/s] 18%|█▊        | 299/1706 [00:03<00:13, 104.72it/s] 18%|█▊        | 311/1706 [00:03<00:13, 105.37it/s] 19%|█▉        | 325/1706 [00:03<00:12, 114.09it/s] 20%|█▉        | 340/1706 [00:03<00:11, 121.50it/s] 21%|██        | 353/1706 [00:03<00:17, 78.17it/s]  21%|██▏       | 364/1706 [00:03<00:16, 80.76it/s] 22%|██▏       | 382/1706 [00:03<00:13, 101.49it/s] 23%|██▎       | 395/1706 [00:03<00:13, 100.46it/s] 24%|██▍       | 411/1706 [00:04<00:11, 112.06it/s] 25%|██▍       | 424/1706 [00:04<00:11, 115.51it/s] 26%|██▌       | 437/1706 [00:04<00:11, 114.69it/s] 26%|██▋       | 450/1706 [00:04<00:10, 114.67it/s] 27%|██▋       | 465/1706 [00:04<00:10, 123.99it/s] 28%|██▊       | 478/1706 [00:04<00:12, 99.87it/s]  29%|██▊       | 489/1706 [00:04<00:13, 92.86it/s] 30%|██▉       | 505/1706 [00:05<00:12, 99.24it/s] 30%|███       | 516/1706 [00:05<00:12, 97.03it/s] 31%|███       | 528/1706 [00:05<00:11, 98.65it/s] 32%|███▏      | 543/1706 [00:05<00:10, 108.65it/s] 33%|███▎      | 555/1706 [00:05<00:11, 96.97it/s]  33%|███▎      | 571/1706 [00:05<00:10, 105.18it/s] 34%|███▍      | 582/1706 [00:05<00:10, 104.64it/s] 35%|███▍      | 593/1706 [00:05<00:13, 81.03it/s]  35%|███▌      | 602/1706 [00:06<00:13, 82.16it/s] 36%|███▌      | 613/1706 [00:06<00:12, 88.68it/s] 37%|███▋      | 623/1706 [00:06<00:11, 90.45it/s] 37%|███▋      | 635/1706 [00:06<00:10, 97.85it/s] 38%|███▊      | 649/1706 [00:06<00:09, 108.55it/s] 39%|███▉      | 665/1706 [00:06<00:08, 119.01it/s] 40%|███▉      | 678/1706 [00:06<00:08, 119.11it/s] 41%|████      | 694/1706 [00:06<00:07, 128.81it/s] 42%|████▏     | 712/1706 [00:06<00:07, 141.06it/s] 43%|████▎     | 727/1706 [00:07<00:08, 114.36it/s] 43%|████▎     | 740/1706 [00:07<00:10, 93.30it/s]  44%|████▍     | 751/1706 [00:07<00:09, 95.82it/s] 45%|████▍     | 762/1706 [00:07<00:10, 92.90it/s] 45%|████▌     | 776/1706 [00:07<00:09, 100.92it/s] 46%|████▌     | 789/1706 [00:07<00:08, 106.20it/s] 47%|████▋     | 803/1706 [00:07<00:08, 106.29it/s] 48%|████▊     | 814/1706 [00:08<00:09, 96.77it/s]  48%|████▊     | 824/1706 [00:08<00:09, 89.42it/s] 49%|████▉     | 834/1706 [00:08<00:10, 86.32it/s] 49%|████▉     | 843/1706 [00:08<00:11, 72.44it/s] 50%|█████     | 858/1706 [00:08<00:09, 88.98it/s] 51%|█████     | 868/1706 [00:08<00:11, 75.51it/s] 51%|█████▏    | 878/1706 [00:08<00:11, 70.61it/s] 52%|█████▏    | 886/1706 [00:09<00:13, 60.15it/s] 53%|█████▎    | 901/1706 [00:09<00:10, 77.90it/s] 54%|█████▎    | 916/1706 [00:09<00:08, 88.71it/s] 55%|█████▍    | 933/1706 [00:09<00:07, 106.61it/s] 55%|█████▌    | 945/1706 [00:09<00:08, 90.36it/s]  56%|█████▌    | 957/1706 [00:09<00:07, 95.99it/s] 57%|█████▋    | 968/1706 [00:09<00:07, 97.63it/s] 57%|█████▋    | 980/1706 [00:10<00:07, 98.02it/s] 58%|█████▊    | 994/1706 [00:10<00:06, 104.22it/s] 59%|█████▉    | 1008/1706 [00:10<00:06, 108.74it/s] 60%|█████▉    | 1020/1706 [00:10<00:06, 107.58it/s] 60%|██████    | 1031/1706 [00:10<00:06, 104.82it/s] 61%|██████    | 1042/1706 [00:10<00:07, 94.77it/s]  62%|██████▏   | 1057/1706 [00:10<00:06, 107.52it/s] 63%|██████▎   | 1070/1706 [00:10<00:05, 112.71it/s] 64%|██████▎   | 1084/1706 [00:10<00:05, 114.69it/s] 64%|██████▍   | 1097/1706 [00:11<00:06, 92.87it/s]  65%|██████▌   | 1113/1706 [00:11<00:05, 107.56it/s] 66%|██████▌   | 1127/1706 [00:11<00:05, 115.34it/s] 67%|██████▋   | 1140/1706 [00:11<00:05, 102.66it/s] 68%|██████▊   | 1154/1706 [00:11<00:05, 109.68it/s] 68%|██████▊   | 1166/1706 [00:11<00:05, 102.51it/s] 69%|██████▉   | 1184/1706 [00:11<00:04, 121.50it/s] 70%|███████   | 1200/1706 [00:11<00:03, 127.60it/s] 71%|███████   | 1214/1706 [00:12<00:04, 122.01it/s] 72%|███████▏  | 1227/1706 [00:12<00:03, 120.22it/s] 73%|███████▎  | 1241/1706 [00:12<00:03, 123.40it/s] 74%|███████▎  | 1254/1706 [00:12<00:04, 105.20it/s] 74%|███████▍  | 1266/1706 [00:12<00:04, 106.36it/s] 75%|███████▌  | 1280/1706 [00:12<00:03, 114.38it/s] 76%|███████▌  | 1296/1706 [00:12<00:03, 125.64it/s] 77%|███████▋  | 1309/1706 [00:12<00:03, 107.19it/s] 77%|███████▋  | 1321/1706 [00:13<00:03, 96.52it/s]  78%|███████▊  | 1336/1706 [00:13<00:03, 104.91it/s] 79%|███████▉  | 1348/1706 [00:13<00:04, 83.25it/s]  80%|███████▉  | 1358/1706 [00:13<00:04, 83.85it/s] 80%|████████  | 1368/1706 [00:13<00:04, 73.24it/s] 81%|████████  | 1379/1706 [00:13<00:04, 79.30it/s] 82%|████████▏ | 1393/1706 [00:13<00:03, 92.49it/s] 83%|████████▎ | 1408/1706 [00:14<00:02, 106.06it/s] 83%|████████▎ | 1420/1706 [00:14<00:02, 101.92it/s] 84%|████████▍ | 1435/1706 [00:14<00:02, 107.43it/s] 85%|████████▍ | 1447/1706 [00:14<00:02, 100.84it/s] 85%|████████▌ | 1458/1706 [00:14<00:02, 94.38it/s]  86%|████████▌ | 1469/1706 [00:14<00:02, 94.43it/s] 87%|████████▋ | 1479/1706 [00:14<00:02, 77.88it/s] 87%|████████▋ | 1489/1706 [00:15<00:02, 82.72it/s] 88%|████████▊ | 1500/1706 [00:15<00:02, 87.63it/s] 89%|████████▊ | 1511/1706 [00:15<00:02, 89.82it/s] 90%|████████▉ | 1527/1706 [00:15<00:01, 105.65it/s] 90%|█████████ | 1540/1706 [00:15<00:01, 104.53it/s] 91%|█████████ | 1551/1706 [00:15<00:01, 98.84it/s]  92%|█████████▏| 1563/1706 [00:15<00:01, 103.64it/s] 92%|█████████▏| 1574/1706 [00:15<00:01, 101.18it/s] 93%|█████████▎| 1585/1706 [00:15<00:01, 87.15it/s]  94%|█████████▎| 1599/1706 [00:16<00:01, 96.71it/s] 95%|█████████▍| 1614/1706 [00:16<00:00, 102.49it/s] 95%|█████████▌| 1625/1706 [00:16<00:00, 97.97it/s]  96%|█████████▌| 1635/1706 [00:16<00:00, 93.36it/s] 96%|█████████▋| 1645/1706 [00:16<00:00, 90.69it/s] 97%|█████████▋| 1655/1706 [00:16<00:00, 89.83it/s] 98%|█████████▊| 1666/1706 [00:16<00:00, 94.70it/s] 98%|█████████▊| 1678/1706 [00:16<00:00, 98.26it/s] 99%|█████████▉| 1688/1706 [00:17<00:00, 63.05it/s] 99%|█████████▉| 1697/1706 [00:17<00:00, 67.75it/s]100%|██████████| 1706/1706 [00:17<00:00, 97.89it/s]
03/21/2025 23:47:58 - INFO - __main__ -   ***** Debugging Inference on Small Sample *****
Traceback (most recent call last):
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 467, in <module>
    main()
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 463, in main
    test_debug(args, model, tokenizer, test_dataset, sample_size=3)
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 310, in test_debug
    (input_ids, attention_mask, labels, decoder_input_ids, target_mask, index) = [x.squeeze(1).to(args.device) for x in batch]
                                                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 310, in <listcomp>
    (input_ids, attention_mask, labels, decoder_input_ids, target_mask, index) = [x.squeeze(1).to(args.device) for x in batch]
                                                                                  ^^^^^^^^^^^^
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
03/21/2025 23:48:13 - WARNING - __main__ -   device: cuda:0, n_gpu: 1
03/21/2025 23:48:13 - WARNING - __main__ -   device: cuda:0, n_gpu: 1
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
03/21/2025 23:48:16 - INFO - __main__ -   Training/evaluation parameters Namespace(output_dir='./saved_models', model_type='t5', encoder_block_size=512, decoder_block_size=256, beam_size=50, model_name='model.bin', checkpoint_model_name='non_domain_model.bin', model_name_or_path='../codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='../codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, load_model_from_checkpoint=False, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=1, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, n_gpu=1, device=device(type='cuda', index=0))
03/21/2025 23:48:16 - INFO - __main__ -   Training/evaluation parameters Namespace(output_dir='./saved_models', model_type='t5', encoder_block_size=512, decoder_block_size=256, beam_size=50, model_name='model.bin', checkpoint_model_name='non_domain_model.bin', model_name_or_path='../codebert-base', config_name='', use_non_pretrained_model=False, tokenizer_name='../codebert-base', code_length=256, do_train=False, do_eval=False, do_test=True, load_model_from_checkpoint=False, evaluate_during_training=False, do_local_explanation=False, reasoning_method=None, train_batch_size=4, eval_batch_size=1, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, max_steps=-1, warmup_steps=0, seed=42, epochs=1, n_gpu=1, device=device(type='cuda', index=0))
  0%|          | 0/1706 [00:00<?, ?it/s]  0%|          | 0/1706 [00:00<?, ?it/s]  1%|          | 14/1706 [00:00<00:12, 139.62it/s]  1%|          | 15/1706 [00:00<00:12, 131.51it/s]  2%|▏         | 28/1706 [00:00<00:14, 115.17it/s]  2%|▏         | 29/1706 [00:00<00:14, 118.27it/s]  2%|▏         | 40/1706 [00:00<00:17, 95.37it/s]   2%|▏         | 41/1706 [00:00<00:16, 98.35it/s]   3%|▎         | 56/1706 [00:00<00:14, 114.02it/s]  3%|▎         | 56/1706 [00:00<00:14, 114.10it/s]  4%|▍         | 68/1706 [00:00<00:16, 101.53it/s]  4%|▍         | 68/1706 [00:00<00:16, 101.53it/s]  5%|▍         | 79/1706 [00:00<00:16, 98.03it/s]   5%|▍         | 79/1706 [00:00<00:16, 97.86it/s]   5%|▌         | 92/1706 [00:00<00:15, 104.94it/s]  5%|▌         | 92/1706 [00:00<00:15, 104.55it/s]  6%|▌         | 103/1706 [00:00<00:15, 105.93it/s]  6%|▌         | 103/1706 [00:00<00:15, 105.54it/s]  7%|▋         | 116/1706 [00:01<00:16, 94.49it/s]   7%|▋         | 116/1706 [00:01<00:16, 93.85it/s]   7%|▋         | 126/1706 [00:01<00:16, 94.68it/s]  7%|▋         | 126/1706 [00:01<00:16, 94.11it/s]  8%|▊         | 136/1706 [00:01<00:17, 90.63it/s]  8%|▊         | 136/1706 [00:01<00:17, 90.14it/s]  9%|▊         | 147/1706 [00:01<00:17, 89.94it/s]  9%|▊         | 147/1706 [00:01<00:17, 89.43it/s]  9%|▉         | 157/1706 [00:01<00:17, 89.57it/s]  9%|▉         | 157/1706 [00:01<00:17, 89.02it/s] 10%|▉         | 166/1706 [00:01<00:18, 85.23it/s] 10%|▉         | 167/1706 [00:01<00:18, 83.87it/s] 10%|█         | 175/1706 [00:01<00:18, 84.15it/s] 10%|█         | 178/1706 [00:01<00:17, 89.64it/s] 11%|█         | 184/1706 [00:02<00:20, 73.48it/s] 11%|█         | 188/1706 [00:02<00:19, 76.30it/s] 12%|█▏        | 197/1706 [00:02<00:17, 84.47it/s] 12%|█▏        | 201/1706 [00:02<00:16, 88.85it/s] 12%|█▏        | 212/1706 [00:02<00:14, 100.19it/s] 13%|█▎        | 216/1706 [00:02<00:14, 103.75it/s] 13%|█▎        | 223/1706 [00:02<00:17, 86.38it/s]  13%|█▎        | 228/1706 [00:02<00:16, 91.45it/s]  14%|█▍        | 243/1706 [00:02<00:13, 105.59it/s] 14%|█▍        | 242/1706 [00:02<00:13, 107.47it/s] 15%|█▌        | 260/1706 [00:02<00:11, 121.87it/s] 15%|█▌        | 260/1706 [00:02<00:11, 123.81it/s] 16%|█▌        | 275/1706 [00:02<00:11, 128.45it/s] 16%|█▌        | 275/1706 [00:02<00:11, 129.53it/s] 17%|█▋        | 289/1706 [00:02<00:12, 109.68it/s] 17%|█▋        | 289/1706 [00:02<00:12, 110.29it/s] 18%|█▊        | 301/1706 [00:03<00:13, 103.97it/s] 18%|█▊        | 301/1706 [00:03<00:13, 104.12it/s] 18%|█▊        | 313/1706 [00:03<00:12, 107.33it/s] 18%|█▊        | 313/1706 [00:03<00:13, 107.10it/s] 19%|█▉        | 328/1706 [00:03<00:11, 117.69it/s] 19%|█▉        | 328/1706 [00:03<00:11, 117.05it/s] 20%|█▉        | 341/1706 [00:03<00:11, 118.82it/s] 20%|█▉        | 341/1706 [00:03<00:11, 118.02it/s] 21%|██        | 354/1706 [00:03<00:17, 78.64it/s]  21%|██        | 354/1706 [00:03<00:17, 78.48it/s]  21%|██▏       | 364/1706 [00:03<00:16, 81.68it/s] 21%|██▏       | 364/1706 [00:03<00:16, 81.50it/s] 22%|██▏       | 382/1706 [00:03<00:12, 103.39it/s] 22%|██▏       | 382/1706 [00:03<00:12, 103.01it/s] 23%|██▎       | 395/1706 [00:03<00:12, 102.09it/s] 23%|██▎       | 395/1706 [00:03<00:12, 101.63it/s] 24%|██▍       | 411/1706 [00:04<00:11, 114.04it/s] 24%|██▍       | 411/1706 [00:04<00:11, 113.38it/s] 25%|██▍       | 424/1706 [00:04<00:10, 117.47it/s] 25%|██▍       | 424/1706 [00:04<00:10, 116.68it/s] 26%|██▌       | 437/1706 [00:04<00:10, 115.98it/s] 26%|██▌       | 437/1706 [00:04<00:11, 114.84it/s] 26%|██▋       | 450/1706 [00:04<00:10, 115.95it/s] 26%|██▋       | 450/1706 [00:04<00:10, 114.87it/s] 27%|██▋       | 466/1706 [00:04<00:10, 122.48it/s] 27%|██▋       | 465/1706 [00:04<00:09, 124.17it/s] 28%|██▊       | 478/1706 [00:04<00:12, 99.80it/s]  28%|██▊       | 479/1706 [00:04<00:13, 91.31it/s]  29%|██▉       | 492/1706 [00:04<00:12, 97.16it/s] 29%|██▊       | 489/1706 [00:04<00:13, 92.86it/s] 30%|██▉       | 505/1706 [00:04<00:11, 103.13it/s] 30%|██▉       | 505/1706 [00:05<00:12, 99.46it/s] 30%|███       | 517/1706 [00:05<00:11, 99.62it/s]  30%|███       | 516/1706 [00:05<00:12, 97.19it/s] 31%|███       | 528/1706 [00:05<00:11, 101.50it/s] 31%|███       | 528/1706 [00:05<00:11, 98.86it/s] 32%|███▏      | 543/1706 [00:05<00:10, 111.23it/s] 32%|███▏      | 543/1706 [00:05<00:10, 108.99it/s] 33%|███▎      | 555/1706 [00:05<00:11, 98.60it/s]  33%|███▎      | 555/1706 [00:05<00:11, 97.26it/s]  33%|███▎      | 571/1706 [00:05<00:10, 106.68it/s] 33%|███▎      | 571/1706 [00:05<00:10, 105.51it/s] 34%|███▍      | 583/1706 [00:05<00:10, 105.91it/s] 34%|███▍      | 582/1706 [00:05<00:10, 104.98it/s] 35%|███▍      | 594/1706 [00:05<00:13, 81.57it/s]  35%|███▍      | 593/1706 [00:05<00:13, 81.70it/s]  36%|███▌      | 606/1706 [00:06<00:12, 88.04it/s] 35%|███▌      | 603/1706 [00:06<00:13, 84.51it/s] 36%|███▌      | 617/1706 [00:06<00:11, 92.11it/s] 36%|███▌      | 614/1706 [00:06<00:12, 90.26it/s] 37%|███▋      | 627/1706 [00:06<00:12, 89.85it/s] 37%|███▋      | 624/1706 [00:06<00:12, 88.43it/s] 38%|███▊      | 643/1706 [00:06<00:09, 107.06it/s] 38%|███▊      | 640/1706 [00:06<00:10, 105.14it/s] 39%|███▊      | 657/1706 [00:06<00:09, 114.26it/s] 38%|███▊      | 654/1706 [00:06<00:09, 111.77it/s] 39%|███▉      | 669/1706 [00:06<00:09, 109.21it/s] 39%|███▉      | 668/1706 [00:06<00:09, 108.85it/s] 40%|████      | 688/1706 [00:06<00:07, 130.17it/s] 40%|████      | 688/1706 [00:06<00:07, 130.80it/s] 41%|████      | 702/1706 [00:06<00:07, 131.29it/s] 41%|████      | 702/1706 [00:06<00:07, 131.61it/s] 42%|████▏     | 717/1706 [00:06<00:07, 136.40it/s] 42%|████▏     | 717/1706 [00:06<00:07, 136.60it/s] 43%|████▎     | 731/1706 [00:07<00:11, 86.19it/s]  43%|████▎     | 731/1706 [00:07<00:11, 86.98it/s]  44%|████▎     | 746/1706 [00:07<00:09, 98.48it/s] 44%|████▎     | 746/1706 [00:07<00:09, 98.90it/s] 44%|████▍     | 759/1706 [00:07<00:09, 104.69it/s] 44%|████▍     | 759/1706 [00:07<00:09, 104.96it/s] 45%|████▌     | 772/1706 [00:07<00:08, 105.15it/s] 45%|████▌     | 772/1706 [00:07<00:08, 105.07it/s] 46%|████▌     | 784/1706 [00:07<00:08, 105.50it/s] 46%|████▌     | 784/1706 [00:07<00:08, 105.50it/s] 47%|████▋     | 796/1706 [00:07<00:08, 107.11it/s] 47%|████▋     | 796/1706 [00:07<00:08, 107.05it/s] 47%|████▋     | 808/1706 [00:07<00:09, 95.01it/s]  47%|████▋     | 808/1706 [00:07<00:09, 94.73it/s]  48%|████▊     | 820/1706 [00:08<00:08, 101.04it/s] 48%|████▊     | 820/1706 [00:08<00:08, 100.62it/s] 49%|████▊     | 831/1706 [00:08<00:10, 87.10it/s]  49%|████▊     | 831/1706 [00:08<00:10, 86.56it/s]  49%|████▉     | 841/1706 [00:08<00:11, 75.42it/s] 49%|████▉     | 841/1706 [00:08<00:11, 74.92it/s] 50%|████▉     | 851/1706 [00:08<00:10, 80.74it/s] 50%|████▉     | 851/1706 [00:08<00:10, 80.16it/s] 50%|█████     | 860/1706 [00:08<00:10, 81.47it/s] 50%|█████     | 860/1706 [00:08<00:10, 80.86it/s] 51%|█████     | 869/1706 [00:08<00:10, 80.62it/s] 51%|█████     | 869/1706 [00:08<00:10, 79.99it/s] 51%|█████▏    | 878/1706 [00:08<00:11, 71.55it/s] 51%|█████▏    | 878/1706 [00:08<00:11, 71.10it/s] 52%|█████▏    | 886/1706 [00:09<00:13, 60.03it/s] 52%|█████▏    | 886/1706 [00:09<00:13, 59.29it/s] 53%|█████▎    | 901/1706 [00:09<00:10, 79.26it/s] 53%|█████▎    | 901/1706 [00:09<00:10, 78.40it/s] 54%|█████▎    | 916/1706 [00:09<00:08, 90.58it/s] 54%|█████▎    | 916/1706 [00:09<00:08, 89.64it/s] 55%|█████▍    | 933/1706 [00:09<00:07, 109.16it/s] 55%|█████▍    | 933/1706 [00:09<00:07, 108.11it/s] 55%|█████▌    | 945/1706 [00:09<00:08, 91.75it/s]  55%|█████▌    | 945/1706 [00:09<00:08, 91.14it/s]  56%|█████▌    | 957/1706 [00:09<00:07, 97.32it/s] 56%|█████▌    | 957/1706 [00:09<00:07, 96.76it/s] 57%|█████▋    | 968/1706 [00:09<00:07, 98.89it/s] 57%|█████▋    | 968/1706 [00:09<00:07, 98.35it/s] 57%|█████▋    | 980/1706 [00:09<00:07, 99.67it/s] 57%|█████▋    | 980/1706 [00:09<00:07, 99.11it/s] 58%|█████▊    | 994/1706 [00:10<00:06, 105.81it/s] 58%|█████▊    | 994/1706 [00:10<00:06, 104.36it/s] 59%|█████▉    | 1007/1706 [00:10<00:06, 111.75it/s] 59%|█████▉    | 1008/1706 [00:10<00:06, 109.08it/s] 60%|█████▉    | 1019/1706 [00:10<00:06, 108.07it/s] 60%|█████▉    | 1020/1706 [00:10<00:06, 107.88it/s] 60%|██████    | 1031/1706 [00:10<00:06, 105.01it/s] 60%|██████    | 1031/1706 [00:10<00:06, 105.30it/s] 61%|██████    | 1042/1706 [00:10<00:06, 95.28it/s]  61%|██████    | 1042/1706 [00:10<00:06, 95.19it/s]  62%|██████▏   | 1057/1706 [00:10<00:06, 108.04it/s] 62%|██████▏   | 1057/1706 [00:10<00:06, 108.05it/s] 63%|██████▎   | 1070/1706 [00:10<00:05, 113.30it/s] 63%|██████▎   | 1070/1706 [00:10<00:05, 113.23it/s] 64%|██████▎   | 1084/1706 [00:10<00:05, 115.50it/s] 64%|██████▎   | 1084/1706 [00:10<00:05, 115.20it/s] 64%|██████▍   | 1097/1706 [00:11<00:06, 93.78it/s]  64%|██████▍   | 1097/1706 [00:11<00:06, 93.44it/s]  65%|██████▌   | 1113/1706 [00:11<00:05, 108.71it/s] 65%|██████▌   | 1113/1706 [00:11<00:05, 108.30it/s] 66%|██████▌   | 1128/1706 [00:11<00:05, 115.05it/s] 66%|██████▌   | 1127/1706 [00:11<00:04, 116.01it/s] 67%|██████▋   | 1141/1706 [00:11<00:05, 105.54it/s] 67%|██████▋   | 1140/1706 [00:11<00:05, 103.28it/s] 68%|██████▊   | 1154/1706 [00:11<00:04, 110.79it/s] 68%|██████▊   | 1154/1706 [00:11<00:05, 110.27it/s] 68%|██████▊   | 1166/1706 [00:11<00:05, 103.76it/s] 68%|██████▊   | 1166/1706 [00:11<00:05, 103.08it/s] 69%|██████▉   | 1185/1706 [00:11<00:04, 123.00it/s] 69%|██████▉   | 1184/1706 [00:11<00:04, 122.18it/s] 70%|███████   | 1200/1706 [00:11<00:03, 129.44it/s] 70%|███████   | 1200/1706 [00:11<00:03, 128.42it/s] 71%|███████   | 1214/1706 [00:11<00:03, 123.67it/s] 71%|███████   | 1214/1706 [00:12<00:04, 122.61it/s] 72%|███████▏  | 1227/1706 [00:12<00:03, 121.78it/s] 72%|███████▏  | 1227/1706 [00:12<00:03, 120.91it/s] 73%|███████▎  | 1241/1706 [00:12<00:03, 125.17it/s] 73%|███████▎  | 1241/1706 [00:12<00:03, 124.32it/s] 74%|███████▎  | 1254/1706 [00:12<00:04, 106.88it/s] 74%|███████▎  | 1254/1706 [00:12<00:04, 106.18it/s] 74%|███████▍  | 1266/1706 [00:12<00:04, 107.84it/s] 74%|███████▍  | 1266/1706 [00:12<00:04, 107.07it/s] 75%|███████▌  | 1280/1706 [00:12<00:03, 115.96it/s] 75%|███████▌  | 1280/1706 [00:12<00:03, 115.12it/s] 76%|███████▌  | 1296/1706 [00:12<00:03, 127.25it/s] 76%|███████▌  | 1296/1706 [00:12<00:03, 126.47it/s] 77%|███████▋  | 1310/1706 [00:12<00:03, 110.03it/s] 77%|███████▋  | 1310/1706 [00:12<00:03, 109.44it/s] 77%|███████▋  | 1322/1706 [00:12<00:03, 97.64it/s]  77%|███████▋  | 1322/1706 [00:13<00:03, 96.84it/s]  78%|███████▊  | 1336/1706 [00:13<00:03, 105.21it/s] 78%|███████▊  | 1336/1706 [00:13<00:03, 104.51it/s] 79%|███████▉  | 1348/1706 [00:13<00:04, 84.75it/s]  79%|███████▉  | 1348/1706 [00:13<00:04, 84.17it/s]  80%|███████▉  | 1358/1706 [00:13<00:04, 85.31it/s] 80%|███████▉  | 1358/1706 [00:13<00:04, 84.85it/s] 80%|████████  | 1368/1706 [00:13<00:04, 74.37it/s] 80%|████████  | 1368/1706 [00:13<00:04, 74.13it/s] 81%|████████  | 1379/1706 [00:13<00:04, 80.50it/s] 81%|████████  | 1379/1706 [00:13<00:04, 80.13it/s] 82%|████████▏ | 1393/1706 [00:13<00:03, 93.89it/s] 82%|████████▏ | 1393/1706 [00:13<00:03, 93.41it/s] 83%|████████▎ | 1408/1706 [00:13<00:02, 107.38it/s] 83%|████████▎ | 1408/1706 [00:14<00:02, 106.94it/s] 83%|████████▎ | 1420/1706 [00:14<00:02, 103.07it/s] 83%|████████▎ | 1420/1706 [00:14<00:02, 102.64it/s] 84%|████████▍ | 1435/1706 [00:14<00:02, 108.62it/s] 84%|████████▍ | 1435/1706 [00:14<00:02, 108.33it/s] 85%|████████▍ | 1447/1706 [00:14<00:02, 101.96it/s] 85%|████████▍ | 1447/1706 [00:14<00:02, 101.57it/s] 85%|████████▌ | 1458/1706 [00:14<00:02, 95.41it/s]  85%|████████▌ | 1458/1706 [00:14<00:02, 94.92it/s]  86%|████████▌ | 1469/1706 [00:14<00:02, 95.39it/s] 86%|████████▌ | 1469/1706 [00:14<00:02, 94.71it/s] 87%|████████▋ | 1479/1706 [00:14<00:02, 78.75it/s] 87%|████████▋ | 1479/1706 [00:14<00:02, 78.25it/s] 87%|████████▋ | 1490/1706 [00:14<00:02, 83.11it/s] 87%|████████▋ | 1489/1706 [00:14<00:02, 83.17it/s] 88%|████████▊ | 1503/1706 [00:14<00:02, 92.10it/s] 88%|████████▊ | 1500/1706 [00:15<00:02, 88.05it/s] 89%|████████▊ | 1513/1706 [00:15<00:02, 91.06it/s] 89%|████████▊ | 1511/1706 [00:15<00:02, 90.25it/s] 90%|████████▉ | 1530/1706 [00:15<00:01, 109.79it/s] 90%|████████▉ | 1527/1706 [00:15<00:01, 106.08it/s] 90%|█████████ | 1542/1706 [00:15<00:01, 104.50it/s] 90%|█████████ | 1540/1706 [00:15<00:01, 105.08it/s] 91%|█████████ | 1553/1706 [00:15<00:01, 94.51it/s]  91%|█████████ | 1551/1706 [00:15<00:01, 99.37it/s]  92%|█████████▏| 1566/1706 [00:15<00:01, 101.12it/s] 92%|█████████▏| 1563/1706 [00:15<00:01, 104.22it/s] 92%|█████████▏| 1577/1706 [00:15<00:01, 89.32it/s]  92%|█████████▏| 1574/1706 [00:15<00:01, 101.72it/s] 93%|█████████▎| 1589/1706 [00:15<00:01, 96.33it/s] 93%|█████████▎| 1585/1706 [00:15<00:01, 87.77it/s]  94%|█████████▍| 1603/1706 [00:15<00:00, 103.17it/s] 94%|█████████▎| 1599/1706 [00:16<00:01, 97.24it/s] 95%|█████████▍| 1615/1706 [00:16<00:00, 104.86it/s] 95%|█████████▍| 1614/1706 [00:16<00:00, 103.62it/s] 95%|█████████▌| 1626/1706 [00:16<00:00, 98.07it/s]  95%|█████████▌| 1625/1706 [00:16<00:00, 99.25it/s]  96%|█████████▌| 1637/1706 [00:16<00:00, 100.23it/s] 96%|█████████▌| 1636/1706 [00:16<00:00, 96.14it/s] 97%|█████████▋| 1648/1706 [00:16<00:00, 97.81it/s]  96%|█████████▋| 1646/1706 [00:16<00:00, 92.79it/s] 97%|█████████▋| 1658/1706 [00:16<00:00, 87.33it/s] 97%|█████████▋| 1656/1706 [00:16<00:00, 87.12it/s] 98%|█████████▊| 1672/1706 [00:16<00:00, 94.92it/s] 98%|█████████▊| 1669/1706 [00:16<00:00, 96.52it/s] 98%|█████████▊| 1680/1706 [00:16<00:00, 99.13it/s] 99%|█████████▊| 1684/1706 [00:16<00:00, 69.25it/s] 99%|█████████▉| 1694/1706 [00:17<00:00, 73.90it/s] 99%|█████████▉| 1691/1706 [00:17<00:00, 64.83it/s]100%|█████████▉| 1703/1706 [00:17<00:00, 73.71it/s]100%|██████████| 1706/1706 [00:17<00:00, 98.99it/s]
03/21/2025 23:48:38 - INFO - __main__ -   ***** Debugging Inference on Small Sample *****
Traceback (most recent call last):
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 467, in <module>
    main()
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 463, in main
    test_debug(args, model, tokenizer, test_dataset, sample_size=3)
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 310, in test_debug
    (input_ids, attention_mask, labels, decoder_input_ids, target_mask, index) = [x.squeeze(1).to(args.device) for x in batch]
                                                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 310, in <listcomp>
    (input_ids, attention_mask, labels, decoder_input_ids, target_mask, index) = [x.squeeze(1).to(args.device) for x in batch]
                                                                                  ^^^^^^^^^^^^
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
100%|█████████▉| 1700/1706 [00:17<00:00, 65.82it/s]100%|██████████| 1706/1706 [00:17<00:00, 98.38it/s]
03/21/2025 23:48:39 - INFO - __main__ -   ***** Debugging Inference on Small Sample *****
Traceback (most recent call last):
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 467, in <module>
    main()
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 463, in main
    test_debug(args, model, tokenizer, test_dataset, sample_size=3)
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 310, in test_debug
    (input_ids, attention_mask, labels, decoder_input_ids, target_mask, index) = [x.squeeze(1).to(args.device) for x in batch]
                                                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre04/scratch/rinao/VulRepair/M2_CodeBERT_PL-NL/codebert_test_debug.py", line 310, in <listcomp>
    (input_ids, attention_mask, labels, decoder_input_ids, target_mask, index) = [x.squeeze(1).to(args.device) for x in batch]
                                                                                  ^^^^^^^^^^^^
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
